## 功能分析

需要实现智能分段显示功能，包括：

1. 长回答自动折叠
2. 支持展开/收起
3. 添加目录导航

## 实现方案

### 1. 创建 CollapsibleContent 组件

* 包装 StreamingContent 组件

* 设置折叠阈值（如 500 字符或 20 行）

* 当内容超过阈值时自动折叠

* 添加"展开全部"/"收起全部"按钮

* 支持平滑过渡动画

### 2. 创建 TableOfContents 组件

* 从内容中提取标题（# ## ### 等）

* 生成可点击的目录列表

* 点击目录项时滚动到对应位置

* 支持深色模式

* 显示在消息右侧或顶部

### 3. 修改 MessageItem 组件

* 集成 CollapsibleContent 组件

* 添加目录导航按钮

* 管理展开/收起状态

### 4. 实现标题提取和导航功能

* 使用正则表达式提取 Markdown 标题

* 为每个标题生成唯一 ID

* 实现点击目录项滚动到对应位置的功能

## 技术实现

* 使用 React hooks 管理状态

* 使用 Tailwind CSS 实现样式

* 使用 React.memo 优化性能

* 支持响应式设计

